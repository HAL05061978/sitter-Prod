(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[36],{4029:function(e,l,t){Promise.resolve().then(t.bind(t,5544))},3519:function(e,l,t){"use strict";t.d(l,{O:function(){return u}});var r=t(1545);let{supabaseUrl:a,supabaseAnonKey:n,appEnv:o,appUrl:s,nodeEnv:i}=function(){let e={NEXT_PUBLIC_SUPABASE_URL:"https://hilkelodfneancwwzvoh.supabase.co",NEXT_PUBLIC_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhpbGtlbG9kZm5lYW5jd3d6dm9oIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkxNjk2OTEsImV4cCI6MjA3NDc0NTY5MX0.MoVQTvTpYcus2xpIZayAXxsCRgNgV8CoP69ZPd6locw",NEXT_PUBLIC_APP_ENV:"development",NEXT_PUBLIC_APP_URL:"http://localhost:3000",NODE_ENV:"production"},l=Object.entries(e).filter(e=>{let[l,t]=e;return!t}).map(e=>{let[l]=e;return l});if(l.length>0)throw Error("Missing required environment variables: ".concat(l.join(", "),"\n")+"Please check your .env file and ensure all required variables are set.");return{supabaseUrl:e.NEXT_PUBLIC_SUPABASE_URL,supabaseAnonKey:e.NEXT_PUBLIC_SUPABASE_ANON_KEY,appEnv:e.NEXT_PUBLIC_APP_ENV,appUrl:e.NEXT_PUBLIC_APP_URL,nodeEnv:e.NODE_ENV}}();"development"===o&&console.log("\uD83D\uDD27 Environment Configuration:",{env:o,supabaseUrl:a.replace(/\/\/.*@/,"//***@"),appUrl:s,nodeEnv:i});let u=(0,r.eI)(a,n,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"X-Client-Info":"sitter-app-".concat(o)}}})},6129:function(e,l,t){"use strict";async function r(e){let l=e.replace(/\D/g,"");if(5!==l.length)return null;try{let e=await fetch("https://api.zippopotam.us/us/".concat(l));if(!e.ok)return null;let t=await e.json();if(t.places&&t.places.length>0){let e=t.places[0];return{zipCode:l,city:e["place name"],state:e["state abbreviation"],county:e.county||void 0}}return null}catch(e){return console.error("Error looking up ZIP code:",e),null}}t.d(l,{f:function(){return r}})},5544:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return i}});var r=t(7437),a=t(2265),n=t(9376),o=t(3519),s=t(6129);function i(){let[e,l]=(0,a.useState)(""),[t,i]=(0,a.useState)(""),[u,c]=(0,a.useState)(""),[d,m]=(0,a.useState)(""),[p,h]=(0,a.useState)(""),[b,f]=(0,a.useState)(""),[g,x]=(0,a.useState)(""),[v,j]=(0,a.useState)(""),[N,y]=(0,a.useState)(""),[w,P]=(0,a.useState)(""),[C,_]=(0,a.useState)(""),[E,k]=(0,a.useState)(""),[I,S]=(0,a.useState)(!1),[U,A]=(0,a.useState)(""),[L,B]=(0,a.useState)(!1),[O,T]=(0,a.useState)(null),X=(0,n.useRouter)(),[D,z]=(0,a.useState)(null);(0,a.useEffect)(()=>{o.O.auth.getUser().then(e=>{let{data:l}=e;return z(l.user)})},[]);let F=async e=>{if(f(e),m(""),5===e.length){let l=await (0,s.f)(e);l&&m(l.city)}},R=async e=>new Promise((l,t)=>{let r=new FileReader;r.onload=e=>{var r;let a=new Image;a.onload=()=>{let e=document.createElement("canvas"),r=a.width,n=a.height;r>n?r>800&&(n*=800/r,r=800):n>800&&(r*=800/n,n=800),e.width=r,e.height=n;let o=e.getContext("2d");o&&o.drawImage(a,0,0,r,n),e.toBlob(e=>{e?l(e):t(Error("Failed to compress image"))},"image/jpeg",.85)},a.onerror=()=>t(Error("Failed to load image")),a.src=null===(r=e.target)||void 0===r?void 0:r.result},r.onerror=()=>t(Error("Failed to read file")),r.readAsDataURL(e)}),M=async e=>{if(D){B(!0),T(null);try{if(!e.type.startsWith("image/")){T("Please select an image file"),B(!1);return}if(e.size>10485760){T("Image file is too large. Please select an image under 10MB."),B(!1);return}let l=await R(e),t=new File([l],e.name,{type:"image/jpeg"}),r="".concat(D.id,"/").concat(Date.now(),"_").concat(e.name.replace(/[^a-zA-Z0-9.-]/g,"_")),{data:a,error:n}=await o.O.storage.from("profile-photos").upload(r,t,{cacheControl:"3600",upsert:!1});if(n){console.error("Upload error:",n),T("Failed to upload photo. Please try again."),B(!1);return}let{data:{publicUrl:s}}=o.O.storage.from("profile-photos").getPublicUrl(r);j(s),T(null),console.log("Profile photo uploaded successfully:",s)}catch(e){console.error("Photo upload error:",e),T("Failed to upload photo. Please try again.")}finally{B(!1)}}},Z=async l=>{if(l.preventDefault(),S(!0),A(""),!e||!t){A("Full name and phone are required"),S(!1);return}if(10!==t.replace(/\D/g,"").length){A("Phone number must be 10 digits"),S(!1);return}if(b&&5!==b.length&&0!==b.length){A("ZIP code must be 5 digits"),S(!1);return}let{error:r}=await o.O.from("profiles").insert([{id:null==D?void 0:D.id,full_name:e.trim(),email:null==D?void 0:D.email,role:"parent",phone:t.trim(),address:u.trim()||null,city:d.trim()||null,state:p.trim()||null,zip_code:b.trim()||null,bio:g.trim()||null,profile_photo_url:v.trim()||null,emergency_contact:N.trim()||null,emergency_contact_phone:w.trim()||null,profession:C.trim()||null,employer:E.trim()||null}]);S(!1),r?A(r.message):X.push("/dashboard")};return D?(0,r.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50 p-4",children:(0,r.jsxs)("form",{onSubmit:Z,className:"bg-white p-6 sm:p-8 rounded shadow-md w-full max-w-3xl",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Create Your Parent Profile"}),U&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-600 rounded",children:U}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("label",{className:"block font-medium",children:"Profile Photo (Optional)"}),(0,r.jsxs)("label",{className:"cursor-pointer",children:[(0,r.jsx)("input",{type:"file",accept:"image/*",capture:"environment",onChange:e=>{var l;let t=null===(l=e.target.files)||void 0===l?void 0:l[0];t&&M(t),e.target.value=""},className:"hidden",disabled:L}),(0,r.jsxs)("div",{className:"p-2 rounded-lg transition flex items-center gap-2 ".concat(L?"bg-gray-200 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"),title:"Upload Photo from Camera/Gallery",children:[(0,r.jsxs)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,r.jsx)("span",{className:"text-white text-sm font-medium",children:L?"Uploading...":"Choose Photo"})]})]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Upload a photo from your camera or gallery (max 10MB, automatically compressed)"}),L&&(0,r.jsx)("p",{className:"text-sm text-blue-600 mt-2",children:"Uploading and compressing photo..."}),O&&(0,r.jsx)("p",{className:"text-sm text-red-600 mt-2",children:O}),v&&!L&&(0,r.jsx)("div",{className:"mt-3 flex justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:"Preview:"}),(0,r.jsx)("img",{src:v,alt:"Profile Preview",className:"w-32 h-32 rounded-full object-cover border-4 border-blue-300",onError:e=>{e.target.style.display="none"}})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Email"}),(0,r.jsx)("input",{type:"email",value:D.email,readOnly:!0,className:"w-full px-3 py-2 border rounded bg-gray-100 cursor-not-allowed"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Full Name *"}),(0,r.jsx)("input",{type:"text",value:e,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Your full name",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Phone *"}),(0,r.jsx)("input",{type:"tel",value:t,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"(123) 456-7890",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Profession"}),(0,r.jsx)("input",{type:"text",value:C,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Teacher, Engineer"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Employer"}),(0,r.jsx)("input",{type:"text",value:E,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Company name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"ZIP Code"}),(0,r.jsx)("input",{type:"text",value:b,onChange:e=>F(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"12345",maxLength:5})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"City"}),(0,r.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"City name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"State"}),(0,r.jsx)("input",{type:"text",value:p,onChange:e=>h(e.target.value.toUpperCase()),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"CA",maxLength:2})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Emergency Contact Name"}),(0,r.jsx)("input",{type:"text",value:N,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Contact name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Emergency Contact Phone"}),(0,r.jsx)("input",{type:"tel",value:w,onChange:e=>P(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"(123) 456-7890"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Address"}),(0,r.jsx)("input",{type:"text",value:u,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Street address"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block mb-1 font-medium",children:"Bio / About Me"}),(0,r.jsx)("textarea",{value:g,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tell us about yourself...",rows:4})]}),(0,r.jsxs)("div",{className:"pt-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"* Required fields"}),(0,r.jsx)("button",{type:"submit",className:"w-full py-3 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium",disabled:I,children:I?"Creating Profile...":"Create Profile"})]})]})]})}):(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."})}}},function(e){e.O(0,[256,971,117,744],function(){return e(e.s=4029)}),_N_E=e.O()}]);